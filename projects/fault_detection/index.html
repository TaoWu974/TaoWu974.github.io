<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> From Fault Detection to Data-Driven Control in Foundries | Tao Wu </title> <meta name="author" content="Tao Wu"> <meta name="description" content="How classical ML, SPC/MPC, and Bayesian neural networks power fault detection and data-driven control in semiconductor fabs"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://taowu974.github.io/projects/fault_detection/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Tao</span> Wu </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About me </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">From Fault Detection to Data-Driven Control in Foundries</h1> <p class="post-description">How classical ML, SPC/MPC, and Bayesian neural networks power fault detection and data-driven control in semiconductor fabs</p> </header> <article> <p>Modern industrial systems‚Äîfrom power plants to chemical process lines‚Äîare becoming increasingly complex, tightly coupled, and heavily sensorized.<br> Faults today rarely appear as sudden failures; instead, they begin as subtle drifts in multivariate data streams long before operators notice anything unusual. In wafer fabs at TSMC or SMIC, that drift quietly erodes yield long before hard alarms fire, making proactive detection economically critical.</p> <p>This makes <strong>early fault detection</strong> a central capability in modern industrial AI‚Äîand the on-ramp to <strong>data-driven control</strong> (MPC/SPC/APC) in foundries.</p> <p>In this post, we explore our work on <strong>Roots Blower blockage detection</strong> as a concrete example, compare multiple classical machine-learning models, and discuss how these ideas extend toward <strong>data-driven control in semiconductor manufacturing</strong> through <strong>Fault Detection</strong>, <strong>Model Predictive Control (MPC)</strong>, <strong>Statistical Process Control (SPC)</strong>, and our ongoing research on <strong>Bayesian Neural Networks (BNNs)</strong>‚Äîa method with powerful potential for small-sample and out-of-distribution scenarios that map directly to fabs.</p> <hr> <h2 id="a-real-world-case-roots-blower-blockage-detection">A Real-World Case: Roots Blower Blockage Detection</h2> <p>Roots blowers are widely used in flue-gas desulfurization systems.<br> In early 2022, a real plant experienced an inlet-pipe blockage incident. Fortunately, the machine was logged with:</p> <ul> <li>8 key sensor measurements</li> <li>Over <strong>450,000 timestamped records</strong> </li> <li>Clear labels for early ‚Äúweak anomaly‚Äù signals observed by operators</li> </ul> <p>The first step was to understand the feature space.<br> Below is a PCA visualization of the entire dataset:</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/publication_preview/PCA_overall-480.webp 480w,/assets/img/publication_preview/PCA_overall-800.webp 800w,/assets/img/publication_preview/PCA_overall-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/publication_preview/PCA_overall.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="PCA distribution of Roots Blower sensor data" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>This view reveals that the normal state and pre-fault state are <strong>strongly separable</strong>‚Äîa promising sign for supervised or semi-supervised learning.</p> <hr> <h2 id="comparing-classical-machine-learning-models">Comparing Classical Machine-Learning Models</h2> <p>We tested six models commonly used in fault detection:</p> <ul> <li>Logistic Regression</li> <li>Neural Network Logistic Regression</li> <li>Random Forest</li> <li>Gradient Boosting Decision Tree (GBDT)</li> <li>Support Vector Data Description (SVDD, one-class method)</li> <li><strong>K-Nearest Neighbors (KNN)</strong></li> </ul> <p>Surprisingly, <strong>all models achieved 100% accuracy on the validation set</strong>, indicating a large separation margin between fault and non-fault samples.</p> <p>But accuracy is not what matters most.</p> <h3 id="what-we-truly-care-about">What we truly care about:</h3> <blockquote> <p><strong>Which model can raise a valid warning earliest‚Äîeven without labeled data in the long ‚Äúgray zone‚Äù where faults begin evolving?</strong></p> </blockquote> <p>To address this, we introduced a <strong>Poisson-based hypothesis test</strong> on the number of predicted anomalies per day.<br> This statistical decision boundary allows each model to raise a warning <em>only when the evidence is strong enough</em>‚Äîa key requirement in industrial SPC contexts.</p> <hr> <h2 id="results-knn-gives-the-earliest-reliable-warning">Results: KNN Gives the Earliest Reliable Warning</h2> <p>The figure below shows the number of predicted anomalies per day for all models, along with each model‚Äôs statistically derived alarm threshold.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/publication_preview/Daily_prediction_counts-480.webp 480w,/assets/img/publication_preview/Daily_prediction_counts-800.webp 800w,/assets/img/publication_preview/Daily_prediction_counts-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/publication_preview/Daily_prediction_counts.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="Daily anomaly counts predicted by ML models" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Among all methods:</p> <ul> <li> <strong>KNN</strong> issued a warning on <strong>December 13th</strong>, nearly <strong>one month before</strong> the actual blockage alarm.</li> <li>This matches the weak anomaly signals operators recorded in the maintenance log.</li> <li>Other models also produced early warnings, though generally later than KNN.</li> </ul> <p>This demonstrates that even simple models‚Äîwhen combined with rigorous statistical logic‚Äîcan serve as robust early-warning systems.</p> <hr> <h2 id="beyond-this-project-the-larger-context">Beyond This Project: The Larger Context</h2> <h3 id="-machine-learning-for-fault-detection">üîß Machine Learning for Fault Detection</h3> <p>ML has become indispensable for fault detection because:</p> <ul> <li>It handles <strong>high-dimensional</strong> sensor data</li> <li>Learns <strong>nonlinear relationships</strong> missed by physical models</li> <li>Provides <strong>early-stage anomaly sensitivity</strong> much greater than classical SPC thresholds</li> <li>Supports continuous, real-time decision making</li> </ul> <p>As industrial systems become more automated, ML-based anomaly detection is rapidly replacing rule-based diagnostics.</p> <hr> <h3 id="-ml--model-predictive-control-mpc">üìà ML + Model Predictive Control (MPC)</h3> <p>Modern MPC relies on accurate prediction models.<br> ML models‚Äîincluding neural networks and ensemble methods‚Äîcan learn complex system dynamics that are difficult to model analytically.<br> This enables:</p> <ul> <li>Better short-term predictions</li> <li>Earlier detection of process drift</li> <li>Preventive control actions before a failure escalates</li> </ul> <p>For nonlinear or poorly modeled systems, ML-enhanced MPC is already becoming standard practice.</p> <hr> <h3 id="-ml--statistical-process-control-spc">üìä ML + Statistical Process Control (SPC)</h3> <p>Traditional SPC assumes independent, low-dimensional, stationary data‚Äîan unrealistic assumption for today‚Äôs industrial sensor networks.</p> <p>ML solves this by:</p> <ul> <li>Extracting latent features</li> <li>Learning nonlinear manifolds</li> <li>Building adaptive control charts in learned feature spaces</li> </ul> <p>This fuses the interpretability of SPC with the powerful pattern-recognition capabilities of ML.</p> <hr> <h2 id="from-fault-detection-to-data-driven-control-in-fabs">From Fault Detection to Data-Driven Control in Fabs</h2> <p>In advanced process control (APC), fabs blend <strong>fault detection</strong>, <strong>SPC</strong>, and <strong>MPC</strong> to keep yield on target:</p> <ul> <li>Line, tool, and chamber signals feed detection models; SPC logic governs holds and lot quarantines.</li> <li>MPC-like controllers adjust recipes and setpoints with safety margins informed by model uncertainty.</li> <li>Cross-chamber learning and fleet analytics enable rapid drift isolation, minimizing scrap and cycle-time hits.</li> </ul> <p>The same ML foundations used for early anomaly sensing become the predictive core of closed-loop control when paired with calibrated uncertainty.</p> <hr> <h2 id="why-bayesian-neural-networks-bnns-are-the-future">Why Bayesian Neural Networks (BNNs) Are the Future</h2> <p>In our earlier research on PA (power-amplifier) and antenna design, <strong>Bayesian Neural Networks</strong> achieved excellent results as surrogate models.<br> BNNs have unique advantages that generalize perfectly to fault detection:</p> <h3 id="-strong-performance-with-small-datasets">‚úî Strong performance with <strong>small datasets</strong> </h3> <p>Critical in industrial settings, where faults are rare.</p> <h3 id="-built-in-uncertainty-estimation">‚úî Built-in <strong>uncertainty estimation</strong> </h3> <p>Aligns naturally with control decisions, SPC charts, and risk-aware alarms.</p> <h3 id="-better-out-of-distribution-ood-robustness">‚úî Better <strong>out-of-distribution (OOD) robustness</strong> </h3> <p>A key requirement when systems drift over months.</p> <h3 id="-supports-probabilistic-mpc">‚úî Supports <strong>probabilistic MPC</strong> </h3> <p>Where future trajectories must include confidence bounds.</p> <p>These properties mirror what <strong>semiconductor fabs</strong> demand:</p> <ul> <li>Excursions and killer defects are rare, so models must work with limited, imbalanced labels.</li> <li>Recipe and tool drifts push data OOD; calibrated uncertainty is essential to decide when to hold lots, reroute wafers, or quarantine chambers.</li> <li>Cross-tool transfer learning and predictive maintenance (vacuum pumps, chillers, etch/CMP/litho modules) benefit from models that know what they <em>don‚Äôt</em> know.</li> <li>In advanced process control (APC) loops, BNN-enabled MPC can steer recipes with confidence bounds, while uncertainty-aware SPC flags subtle drifts without over-triggering holds or scrapping lots.</li> </ul> <p>For systems like Roots Blowers, pumps, compressors, turbines‚Äîand high-value wafer fabrication lines at TSMC and SMIC‚ÄîBNNs are a compelling path to earlier warnings, safer control, and higher yield.</p> <hr> <h2 id="conclusion">Conclusion</h2> <ul> <li>In this case, classical ML plus SPC logic raised credible early warnings (KNN led).</li> <li>Data-driven control (MPC/SPC) is becoming a practical bridge from detection to action in fabs and other assets.</li> <li>BNNs look promising for small-sample, uncertainty-aware decisions in yield-critical fabs (TSMC, SMIC), but remain an active area of applied research.</li> </ul> <p>Taken together, these tools suggest a measured path toward more robust, data-driven operations in the fabs.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> ¬© Copyright 2025 Tao Wu. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>